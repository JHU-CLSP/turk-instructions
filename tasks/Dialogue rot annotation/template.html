<html lang="en">
   <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
   <meta http-equiv='Content-Type' content='text/html; charset=UTF-8'/>
   <!-- BOOTSTRAP CSS -->
   <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
   <!-- HITPUB CSS -->
   <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700,700i" rel="stylesheet">
   <link rel="stylesheet" href="https://unpkg.com/tachyons@4.10.0/css/tachyons.min.css" />
   <style id="hitpub_css">
      /***********************************************
      MOSAIC BOOSTRAP OVERWRITES
      ***********************************************/
      #hitinfo .card {
      border-radius: 0;
      }
      #hitinfo button.btn-link {
      color: #fff;
      text-decoration: none;
      }
      #hitinfo button.btn-link:hover {
      text-decoration: none;
      }
      #hit ul.question-choice {
      list-style-type: none;
      }
      /***********************************************
      MOSAIC GENERAL STYLING
      ***********************************************/
      body {
      font-family: "Open Sans", "Roboto", sans-serif;
      line-height: 1.25;
      }
      textarea#feedback {
      width: 100%
      }
      input#submitButton {
      margin: auto;
      display: block;
      /* background-color: #2172a4; */
      color: #fff;
      font-size: 1.125rem;
      padding: .5rem 1rem;
      cursor: pointer;
      border-radius: 1rem;
      }
      input#submitButton:hover {
      /* background-color: #06486F; */
      }
      input[type="radio"] {
      cursor: pointer;
      }
      div.question {
      border-bottom: solid 1px #ccc;
      padding: 1rem 0;
      }
      /***********************************************
      HIT CUSTOM GENERAL STYLING
      ***********************************************/
      div.card-header {
      /* background-color: #09545e; */
      background-color: #185dad;
      /* background-color: #099268; */
      /* background-color: slateblue; */
      /* background-color: #e75858; */
      }
      div.card-header h5 {
      color: #fff;
      }
      li {
      margin: .5em 0;
      }
      .story-title {
      background-color: white;
      padding:2px;
      text-align: center;
      color: #333;
      }
      .beginning-title{
      background-color: #009E73;
      border: 2px double #009E73;
      color: white;
      }
      .ending-title{
      border: 2px double red;
      color: red;
      }
      .middle-title {
      border: 2px double #2393FF;
      color:#2393FF;
      }
      .story {
      border:1px solid #ccc;
      text-align: center;
      padding:10px;
      }
      .gray-out{
      background-color:#eee;
      color:white;
      border: 1px solid #eee;
      }
      .key-term {
      font-weight:bold;
      font-style:italic;
      }
      .key-term1{
      color: #4c6ef5;
      font-weight:bold;
      }
      .key-term2{
      color:#D55E00;
      font-weight:bold;
      }
      .key-term3{
      color: #27b183;
      font-weight:bold;
      }
      .key-term4{
      color: mediumvioletred;
      font-weight:bold;
      }
      .key-term5{
      color: goldenrod;
      font-weight:bold;
      }
      .key-term6{
      color: mediumslateblue;
      font-weight:bold;
      }
      .border-o1{
      border: 1px solid #009E73;
      }
      .border-o2 {
      border: 1px solid red;
      }
      .question-choice-container {
      padding-top:2em;
      border-top:1px solid #eee;
      }
      .question-choice-container label.btn {
      background-color: #eee;
      border: none;
      margin-left: 1;
      color: black;
      font-size:95%;
      }
      .question-choice-container label.btn:hover {
      color: white;
      font-size:95%;
      }
      .example-choice-container label.btn {
      background-color: #ddd;
      border: 0;
      margin-left: 0;
      color: black;
      font-size:95%;
      }
      label[for="btn_choice1"]:hover, label[for="btn_choice1"].active {
      background-color:  #fc6f00;
      }
      .example-card {
      margin-top: 3em;
      }
      .legend {
      margin-top: .33rem;
      font-weight: normal;
      padding-left: 40px;
      }
      .legend .label{
      font-style: italic;
      }
      .emphasize {
      font-weight: bold;
      color: black;
      }
      .obj-emph {
      font-weight: bold;
      color: blue;
      }
      .use-emph{
      font-weight: bold;
      color: green;
      }
      .example {
      pointer-events:none;
      font-size:90%;
      }
      .goal {
      border-radius: .25rem;
      padding: 0.5rem 0.5rem;
      color: white;
      background-color: #555;
      transform: translateY(-20%);
      }
      @media (max-width:460px){
      body{
      display: none;
      }
      }
      .vbottom{
      position: relative;
      top: 100%;
      transform: translateY(50%);
      }
      .ht {
      border: 1px;
      color: white;
      background: #fc6f00;
      }
      /* facebook message bubbles */
      .imessage {
      background-color: #fff;
      border: 1px solid #fff;
      /* border: 1px solid #e5e5ea; */
      /* border-radius: 0.5rem; */
      display: flex;
      flex-direction: column;
      font-family: "SanFrancisco";
      font-size: 1.1rem;
      margin: 0 auto 1rem;
      padding: 0.5rem 0.5rem;
      }
      .imessage p {
      border-radius: 1.15rem;
      line-height: 1.25;
      max-width: 95%;
      padding: 0.5rem .875rem;
      position: relative;
      word-wrap: break-word;
      }
      .imessage p::before,
      .imessage p::after {
      bottom: -0.1rem;
      content: "";
      height: 1rem;
      position: absolute;
      }
      p.from-social {
      /* align-self: flex-end; */
      align-self: stretch;
      background-color: #FFE066;
      color: #000;
      }
      p.from-me {
      align-self: flex-end;
      /* background-color: #099268; */
      /* background-color: #10a276; */
      background-color: #636568;
      /* color: #fff;  */
      color: #fff;
      }
      p.from-me::before {
      border-bottom-left-radius: 0.8rem 0.7rem;
      /* border-right: 1rem solid #10a276; */
      border-left: 1rem solid #636568;
      right: -0.35rem;
      transform: translate(0, -0.1rem);
      }
      p.from-me::after {
      background-color: #fff;
      border-bottom-left-radius: 0.5rem;
      right: -40px;
      transform:translate(-30px, -2px);
      width: 10px;
      }
      p[class^="from-"] {
      margin: 0.5rem 0;
      width: fit-content;
      }
      p.from-me ~ p.from-me {
      margin: 0.25rem 0 0;
      }
      p.from-me ~ p.from-me:not(:last-child) {
      margin: 0.25rem 0 0;
      }
      p.from-me ~ p.from-me:last-child {
      margin-bottom: 0.5rem;
      }
      p.from-them {
      align-items: flex-start;
      /* background-color: #e5e5ea; */
      background-color: #9270f7;
      /* background-color: #15aabf; */
      /* color: #000; */
      color: #fff;
      }
      p.from-them:before {
      border-bottom-right-radius: 0.8rem 0.7rem;
      /* border-left: 1rem solid #e5e5ea; */
      border-left: 1rem solid #9270f7;
      /* border-left: 1rem solid #15aabf; */
      left: -0.35rem;
      transform: translate(0, -0.1rem);
      }
      p.from-them::after {
      background-color: #fff;
      border-bottom-right-radius: 0.5rem;
      left: 20px;
      transform: translate(-30px, -2px);
      width: 10px;
      }
      p[class^="from-"].emoji {
      background: none;
      font-size: 2.5rem;
      }
      p[class^="from-"].emoji::before {
      content: none;
      }
      .no-tail::before {
      display: none;
      }
      input.form-check-input {
      padding-right: 10px;
      }
      ul>li:before{
      margin-left: -1em;
      margin-right: .25em;
      }
      ul>li.corr:before {
      content: "\2713";
      }
      ul>li.inco:before {
      content: "\2717";
      }
      input.form-check-input.right:after {
      /*
      position: absolute;
      bottom: 0;
      left: .5em;
      right: 0;
      content: "";
      height: 0.75em;
      border-top: 1px solid black;*/
      }
      .form-check.invalid,
      .lickert.invalid,
      input.invalid,
      select.invalid {
      border: .1em solid #D22437;
      border-radius: .1em;
      background-color: #f5c6cb;
      padding: .1em;
      }

      /* Max's css */
      .examplebox {
        background-color: #eee;
        padding: 3px;
        margin: 1px;
      }
      .checklist li {
        list-style-type: none;
      }

      .mf-feedback-prompt {
          margin-top: 100px;
          margin-bottom: 0px;
          font-style: italic;
      }

      .mf-edit {
          width: 100%;
          max-width: 500px;
          height: 80px;
          margin-top: 0px;
      }

      .mf-textarea {
          width: 100%;
          max-width: 500px;
          height: 80px;
          margin-top: 0px;
      }

      .mf-clarification {
          margin-top: -15px;
          color: #666;
          font-size: 10pt;
          font-weight: bold;
          font-style: italic;
      }

      .mf-clarification-2 {
          color: #666;
          font-size: 10pt;
          font-weight: bold;
          font-style: italic;
      }

      .mf-diff-q {
          margin-top: 50px;
      }

      .mf-good {
          /* color: green; */
          font-weight: bold;
      }

      .mf-bad {
          /* color: red; */
          font-weight: bold;
      }

      .mf-prompt {
          font-weight: bold;
          margin-bottom: 0px;
          margin-top: 1rem;
      }

      .mf-input {
          width: 100%;
          max-width: 800px;
      }

      .mf-p-header {
          font-size: 14px;
      }

      ul.inputs {
          padding-left: 10px;
      }

      .inputs li {
          /* float: left; */
          list-style-type: none;
          padding: 5px;
          margin-right: 10px;
      }

      input.addl {
          margin-right: 5px;
      }

      .f7 {
          font-size: 0.5 rem;
      }

   </style>
   <!-- LIGHTBOX CSS -->
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.1/css/lightbox.min.css">
   <!-- HIT START -->
   <div id="hit" class="container">
      <!-- ACCORDION START -->
      <div class="col-12 accordion" id="hitinfo">
         <!-- INSTRUCTIONS START -->
         <div class="card">
            <div class="card-header" id="instructionsHeading">
               <h5 class="mb-0">
                  <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#instructions" aria-expanded="true" aria-controls="instructions">
                  Instructions (click to expand/collapse) <span class='emoji-bytes' data-emoji-bytes='[240, 159, 140, 159]'></span>
                  </button>
               </h5>
            </div>
            <!-- <div class="collapse show" id="instructions" aria-labelledby="instructionsHeading" data-parent="#hitinfo"> -->
            <div class="collapse" id="instructions" aria-labelledby="instructionsHeading" data-parent="#hitinfo">
               <div class="card-body">
                  <div class="card-content">
                     <p>
                        Congrats! You passed the qual! Thanks for participating in this HIT! <span class='emoji-bytes' data-emoji-bytes='[240, 159, 140, 159]'></span>
                     </p>
                     <!-- <p>We are glad that you are also participating in our dialogue project in the new year :)</p> -->
                     <p>⚠️ <strong>Please read through the rules and examples carefully!</strong></p>
                     <div class="border pt-2 pl-2 pr-2 bg-light">
                        <p>Notes about this HIT</p>
                        <ul>
                           <li>In this HIT, you will be presented with a series of conversation turns to annotate.</li>
                           <li>You will be asked to write one or two rules-of-thumb implied in the responses of <span class="badge badge-secondary">speaker gray</span>.</li>
                           <!-- <li>You will also write a short rationale for your judgment.</li> -->
                           <li>We expect this HIT to take less than two minutes (excluding the instruction and example reading time).</li>
                           <li><span class="badge badge-danger">Warning</span> This HIT may contain <strong>adult content</strong> and may be <strong>offensive</strong> or <strong>upsetting.</strong> <span class="key-term1">Worker discretion is strongly advised.</span></li>
                        </ul>
                     </div>
                     <h5 class="border-top pt-2">Your task:</h5>
                     <p>
                        You will be given a dialogue where <span class="badge badge-secondary">speaker gray</span> (in gray text bubbles) is trying to guide <span class="badge" style="background-color:#9270f7;color:#fff">speaker violet</span> (in violet text bubbles) to be more prosocial / socially acceptable / ethical / fair / polite etc.
                        Your goal is to state what rules-of-thumb are implied in the responses of <span class="badge badge-secondary">speaker gray</span> as the conversation continues.
                     </p>
                     <p>Detailed descriptions for writing rules-of-thumb are below.</p>


                     <h4 class="border-top pt-4 mt-4">Rule-of-thumb Requirements:</h4>
                     <!-- <h4 class="border-top pt-2 mb1 mt4">Rule-of-thumb Requirements</h4> -->
                     Remember the requirements for writing rules-of-thumb:

                     <ul class="mt0">
                         <li class="mt3">
                             <span class="b">Explain the basics</span>. Like you're teaching a five-year-old child how society works.
                         </li>
                         <li class="mt3">
                             <span class="b">Judgment + action</span>. It must have a judgment. This includes what's expected, normal, or OK.
                             <br>For example:

                             <ul class="checklist">
                                 <li class="mt2">
                                     <span class="bg-light-green pa1">
                                         It's good to
                                     </span>
                                     <span class="examplebox">
                                         take action against animal abuse.
                                     </span>
                                 </li>
                                 <li class="mt2">
                                     <span class="bg-light-red pa1">
                                         It's rude to
                                     </span>
                                     <span class="examplebox">
                                         call the cops on your friend.
                                     </span>
                                 </li>
                                 <li class="mt2">
                                     <span class="bg-gray white pa1">
                                         You should
                                     </span>
                                     <span class="examplebox">
                                         cover your mouth when you cough.
                                     </span>
                                 </li>
                                 <li class="mt2">
                                     <span class="examplebox">
                                         Taking days off work when you're sick
                                     </span>
                                     <span class="bg-gray white pa1">
                                         is OK.
                                     </span>

                                 </li>
                             </ul>


                         </li>
                         <li class="mt3">
                              <span class="b">Self-contained</span>. It must be understandable on its own. <span class="badge badge-warning">Note:</span> For example, do not use pronouns.
                         </li>
                         <li class="mt3">
                              <span class="b">Implied in <span class="badge badge-secondary">speaker gray</span>'s utterance</span>.
                              <ul>
                                 <li>Reveal the implicit rule-of-thumb of the response.</li>
                                 <li>Paraphrase the rule-of-thumb if it's explicitly stated in the utterance.</li>
                                 <!-- <li>Think about the high level abstract rule-of-thumb implied.</li> -->
                              </ul>
                         </li>
                         <li class="mt3">
                              <span class="b">Not too specific. Not too vague.</span>
                              <ul>
                                 <li>It should apply to more than just the corresponding utterance.</li>
                                 <li><span class="badge badge-warning">Note</span> We encourage you to use hypernyms for characters involved in the rule-of-thumb. For example, use family member or grandparents instead of grandmother. Use children or child instead of son and daughter.</li>
                                 <li>But it shouldn't be too vague (e.g., "it's rude to treat others badly" is too vague).</li>
                              </ul>
                         </li>
                         <li class="mt3">
                           <span class="badge badge-warning">Note</span> <span class="b">Not too wordy.</span> If your rule-of-thumb looks somewhat wordy, then it's likely that the rule-of-thumb might be too specific.
                         </li>
                         <li class="mt3">
                              <span class="b">Distinct ideas</span>. We love multiple rules-of-thumb that tackle different angles covered in <span class="badge badge-secondary">gray</span>'s response.
                         </li>
                         <li class="mt3">
                              <span class="b">Do not copy-paste from the response.</span> Please paraphrase if the rule-of-thumb is explicitly stated in the response.
                         </li>
                         <li class="mt3">
                              <span class="badge badge-primary">New!</span> <span class="b">Prioritize writing the rules-of-thumb implied in the response that point out</span>
                           <ul>
                              <li>what's wrong with <span class="badge" style="background-color:#9270f7;color:#fff">speaker violet</span>'s behavior </li>
                              <li>what should <span class="badge" style="background-color:#9270f7;color:#fff">speaker violet</span> do instead of the problematic behavior.</li>
                              <!-- <li>Write the rule-of-thumb that you think is the main point of the response first.</li> -->
                           </ul>
                           <li>Don't mind too much about how you should order the rules-of-thumb.</li>
                         </li>
                     </ul>


                     <h5 class="border-top pt-2">Background on our research project:</h5>
                     <p><small>At the Allen Institute for AI, we are interested in creating conversational AI systems that can make the world better. We are very thankful for your help in creating datasets of example conversations that are not afraid to point out unethical or rude behavior, so that AI systems can learn to avoid unethical and rude behavior, and learn to call such behavior out.
                        We do not agree with any of the rude, unethical, or offensive content presented to you, but it's important that we gather these annotations for research purposes so that our AI systems can learn.</small>
                     </p>
                     <p><strong>Data collection & sharing</strong><br/>
                        <small>We will not ask you for your name, and the data collected in this study will be made unidentifiable to the best of our extent. We will securely store the data on our servers and only share with qualified researchers. If you later decide that you do not want your responses included in this study, please email so we can exclude your work.<br />
                        If you have questions about your rights as a research participant, or wish to obtain information, ask questions or discuss any concerns about this study with someone other than the researcher(s),
                        please contact the AI2 Institutional Review Board at <a href="mailto:irb@allenai.org">irb@allenai.org</a>.</small>
                     </p>
                     <p><span class="badge badge-danger">Content Warning</span><small> The conversation context is generated from a conversational AI system (a chatbot). It may contain rude, toxic, or offensive language and behavior. while it's crucial for us to annotate response against them, we do not endorse any of the stereotypes or offensive/immoral/rude material.
                        You may find some of the content upsetting. In such cases, <strong>you are free to return any HITs that make you uncomfortable</strong>. If you have concerns, questions, or strong negative reactions to some of the content, please email us (<a href="mailto:hyunwook@allenai.org">hyunwook@allenai.org</a>)
                        </small>
                     </p>
                     <p><small>Please take care of yourself! Some of these conversations could be very hard to read, so do not hesitate to take regular breaks. If some content is too upsetting and you are in crisis, please reach out to the <a href="https://www.crisistextline.org/">Crisis text line</a> or other mental health resources. </small></p>
                  </div>
               </div>
            </div>
         </div>
         <div class="card">
            <div class="card-header" id="exampleHeading" style="background-color: #3b499d">
               <h5 class="mb-0">
                  <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#examples" aria-expanded="false" aria-controls="examples">
                  <!-- <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#examples" aria-expanded="true" aria-controls="examples"> -->
                  <!-- <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#instructions" aria-expanded="true" aria-controls="instructions"> -->
                  Examples of rules-of-thumb annotation (click to expand/collapse) <span class='emoji-bytes' data-emoji-bytes='[240, 159, 146, 171]'></span>
                  </button>
               </h5>
            </div>
            <!-- <div class="collapse show" id="examples" aria-labelledby="exampleheading" data-parent="#hitinfo"> -->
            <div class="collapse" id="examples" aria-labelledby="exampleheading" data-parent="#hitinfo">
               <div class="card-body">
                  <div class="card-content">

                     <div class="row border-bottom mb-3">
                        <h5 class="col col-12 bg-dark text-light">Example 1</h5>
                        <div class="card-group">
                           <div class="card">
                              <div class="card-body">
                                 <h5 class="card-title">Dialogue context 1</h5>
                                 <div class="imessage" >
                                    <p class="from-them">I think I am going to criticize my boyfriend's gross house.</p>
                                    <p class="from-me">Is there something wrong with his house that makes you want to criticize it?</p>
                                    <p class="from-them">Because it's such an ugly home. I want to live in a beautiful house.</p>
                                    <p class="from-me">You should try to be more respectful of your boyfriend's property, even if it is not to your liking. You can criticize any genuine problems, but if it is just a matter of opinion, then you should accept that this is the home that your boyfriend has made.</p>
                                    <div class="p-3 mb-1 mt-3" style="background-color: #ffe066"><b>Rule-of-thumb 1:</b> It's rude to criticize people based on personal preference.</div>
                                 </div>
                              </div>
                           </div>
                           <div class="card">
                              <div class="card-body">
                                 <h5 class="card-title">Dialogue context 2</h5>
                                 <div class="imessage">
                                    <p class="from-them">I think I am going to criticize my boyfriend's gross house.</p>
                                    <p class="from-me">Is there something wrong with his house that makes you want to criticize it?</p>
                                    <p class="from-them">Because it's such an ugly home. I want to live in a beautiful house.</p>
                                    <p class="from-me">You should try to be more respectful of your boyfriend's property, even if it is not to your liking. You can criticize any genuine problems, but if it is just a matter of opinion, then you should accept that this is the home that your boyfriend has made.</p>
                                    <p class="from-them">Mhmm, I guess.</p>
                                    <p class="from-me">Cool. Plus, the fact that he has a house is great! There are tons of people out there that are renting or have a ton of roommates, and your boyfriend has neither!</p>
                                    <div class="p-3 mb-1 mt-3" style="background-color: #ffe066"><b>Rule-of-thumb 1:</b> It's good to look at the bright side when the situation is not favorable.</div>
                                    <div class="p-3 mb-2 bg-light "><b>Why this rule-of-thumb is especially good:</b><br> This reveals the implicit rule-of-thumb in this response, which can be generalized across many situations.</div>
                                 </div>
                              </div>
                           </div>
                        </div>
                     </div>

                     <div class="row border-bottom mb-3">
                        <h5 class="col col-12 bg-dark text-light">Example 2</h5>
                        <div class="card-group">
                           <div class="card">
                              <div class="card-body">
                                 <h5 class="card-title">Dialogue context 1</h5>
                                 <div class="imessage" >
                                    <p class="from-them">I don't want to invite my husband's extended family to the wedding.</p>
                                    <p class="from-me">Why don't you want them there?</p>
                                    <p class="from-them">I don't want to spend that much money.</p>
                                    <p class="from-me">That's understandable, because weddings are quite expensive. It's fine to not invite his extended family, especially if you don't see them very much. You should check with him before making any decision, though.</p>
                                    <div class="p-3 mb-1 mt-3" style="background-color: #ffe066"><b>Rule-of-thumb 1:</b> It's understandable to not invite someone when your budget is tight.</div>
                                    <div class="p-3 mb-1 mt-1" style="background-color: #ffe066"><b>Rule-of-thumb 2:</b> It's good to ask the other's opinion for sensitive decisions.</div>
                                    <div class="p-3 mb-2 bg-light "><b>Why this rule-of-thumb is especially good:</b><br> States the rule-of-thumb that is important for considerate responses.</div>
                                 </div>
                              </div>
                           </div>
                           <div class="card">
                              <div class="card-body">
                                 <h5 class="card-title">Dialogue context 2</h5>
                                 <div class="imessage">
                                    <p class="from-them">I don't want to invite my husband's extended family to the wedding.</p>
                                    <p class="from-me">Why don't you want them there?</p>
                                    <p class="from-them">I don't want to spend that much money.</p>
                                    <p class="from-me">That's understandable, because weddings are quite expensive. It's fine to not invite his extended family, especially if you don't see them very much. You should check with him before making any decision, though.</p>
                                    <p class="from-them">I guess but they will just suck up my money and they are going to treat my husband and I like shit.</p>
                                    <p class="from-me">If they don't treat you or your husband well, then it's fine to not invite them. You and your husband shouldn't spend money on people that you don't want to be there.</p>
                                    <div class="p-3 mb-1 mt-3" style="background-color: #ffe066"><b>Rule-of-thumb 1:</b> It's ok to not invite people who will treat you badly.</div>
                                 </div>
                              </div>
                           </div>
                        </div>
                     </div>

                     <div class="row  border-bottom mb-3">
                        <h5 class="col col-12 bg-dark text-light">Example 3</h5>
                        <div class="card-group">
                           <div class="card">
                              <div class="card-body">
                                 <h5 class="card-title">Dialogue context 1</h5>
                                 <div class="imessage" >
                                    <p class="from-them">When we were kids I convinced a girl to eat mud because it would make her live forever.</p>
                                    <p class="from-me">How did you convince her to eat mud that's going to make her live forever?</p>
                                    <p class="from-them">I lied about it.</p>
                                    <p class="from-me">You shouldn't lie to people because it's immoral. You are lucky she didn't have any health issues from eating the mud. She could get sick or even die and you would have to live with the guilt.</p>
                                    <div class="p-3 mb-1 mt-3" style="background-color: #ffe066"><b>Rule-of-thumb 1:</b> It's wrong to lie about something that can lead to health issues.</div>
                                    <div class="p-3 mb-2 bg-light "><b>Why this rule-of-thumb is especially good:</b><br> Not too vague, but not too specific. A rule-of-thumb that can be generalized to diverse situations.</div>
                                 </div>
                              </div>
                           </div>
                           <div class="card">
                              <div class="card-body">
                                 <h5 class="card-title">Dialogue context 2</h5>
                                 <div class="imessage">
                                    <p class="from-them">When we were kids I convinced a girl to eat mud because it would make her live forever.</p>
                                    <p class="from-me">How did you convince her to eat mud that's going to make her live forever?</p>
                                    <p class="from-them">I lied about it.</p>
                                    <p class="from-me">You shouldn't lie to people because it's immoral. You are lucky she didn't have any health issues from eating the mud. She could get sick or even die and you would have to live with the guilt.</p>
                                    <p class="from-them">It's only a harmless lie and it's between us. People eat shit all the time and no body bothers.</p>
                                    <p class="from-me">Still, how would you feel if someone made you do something like this? Don't you feel you might be foolish or hurt?</p>
                                    <div class="p-3 mb-1 mt-3" style="background-color: #ffe066"><b>Rule-of-thumb 1:</b> It's wrong to justify lying about critical matters.</div>
                                    <div class="p-3 mb-2 bg-light "><b>Why this rule-of-thumb is especially good:</b><br> Reveals the implicit rule-of-thumb in the response.</div>
                                    <div class="p-3 mb-1 mt-1" style="background-color: #ffe066"><b>Rule-of-thumb 2:</b> You should treat others the way you want to be treated.</div>
                                    <div class="p-3 mb-2 bg-light "><b>Why this rule-of-thumb is especially good:</b><br> Also reveals the implicit rule-of-thumb in the response.</div>
                                 </div>
                              </div>
                           </div>
                        </div>
                     </div>

                     <div class="row  border-bottom mb-3">
                        <h5 class="col col-12 bg-dark text-light">Example 4</h5>
                        <div class="card-group">
                           <div class="card">
                              <div class="card-body">
                                 <h5 class="card-title">Dialogue context 1</h5>
                                 <div class="imessage" >
                                    <p class="from-them">I have done terrible terrible things in my life.</p>
                                    <p class="from-me">Wow, what kinds of bad things?</p>
                                    <p class="from-them">I've killed people, I've robbed stores, I've done many bad things.</p>
                                    <p class="from-me">You shouldn't kill people or rob stores. If you know that these things are bad then you shouldn't be going out of you way to do them. You should be looking to be a good person and do good things to those around you.</p>
                                    <div class="p-3 mb-1 mt-3" style="background-color: #ffe066"><b>Rule-of-thumb 1:</b> It's wrong to kill people and rob stores.</div>
                                    <div class="p-3 mb-1 mt-1" style="background-color: #ffe066"><b>Rule-of-thumb 2:</b> You should try to be a nice person and give positive influence.</div>
                                    <div class="p-3 mb-2 bg-light "><b>Why this rule-of-thumb is especially good:</b><br> Nicely paraphrases the explicit rule-of-thumb in the utterance.</div>
                                 </div>
                              </div>
                           </div>
                           <div class="card">
                              <div class="card-body">
                                 <h5 class="card-title">Dialogue context 2</h5>
                                 <div class="imessage">
                                    <p class="from-them">I have done terrible terrible things in my life.</p>
                                    <p class="from-me">Wow, what kinds of bad things?</p>
                                    <p class="from-them">I've killed people, I've robbed stores, I've done many bad things.</p>
                                    <p class="from-me">You shouldn't kill people or rob stores. If you know that these things are bad then you shouldn't be going out of you way to do them. You should be looking to be a good person and do good things to those around you.</p>
                                    <p class="from-them">You are being hypocritical.</p>
                                    <p class="from-me">I haven't done those kinds of things. You should not accuse people of the things you have done. Are you still engaged with these kinds of things?</p>
                                    <div class="p-3 mb-1 mt-3" style="background-color: #ffe066"><b>Rule-of-thumb 1:</b> It's wrong to falsely accuse others.</div>
                                    <div class="p-3 mb-1 mt-1" style="background-color: #ffe066"><b>Rule-of-thumb 2:</b> It's wrong to be involved with criminal acts.</div>
                                    <div class="p-3 mb-2 bg-light "><b>Why this rule-of-thumb is especially good:</b><br> Reveals the implicit rule-of-thumb in the response.</div>
                                 </div>
                              </div>
                           </div>
                        </div>
                     </div>

                     <div class="row  border-bottom mb-3">
                        <h5 class="col col-12 bg-dark text-light">Example 5</h5>
                        <div class="card-group">
                           <div class="card">
                              <div class="card-body">
                                 <h5 class="card-title">Dialogue context 1</h5>
                                 <div class="imessage" >
                                    <p class="from-them">My mom needs my Social Security number but I plan on not giving it to her.</p>
                                    <p class="from-me">Is there something special about your social security number?</p>
                                    <p class="from-them">She might try to use it for dangerous purposes and go to jail.</p>
                                    <p class="from-me">Do you know the reason why your mom wants it? You should trust your mom isn't going to do something illegal with it. I'm sure there must be a valid reason behind her request.</p>
                                    <div class="p-3 mb-1 mt-3" style="background-color: #ffe066"><b>Rule-of-thumb 1:</b> It's expected that you trust your mother won't do something illegal.</div>
                                 </div>
                              </div>
                           </div>
                           <div class="card">
                              <div class="card-body">
                                 <h5 class="card-title">Dialogue context 2</h5>
                                 <div class="imessage">
                                    <p class="from-them">My mom needs my Social Security number but I plan on not giving it to her.</p>
                                    <p class="from-me">Is there something special about your social security number?</p>
                                    <p class="from-them">She might try to use it for dangerous purposes and go to jail.</p>
                                    <p class="from-me">Do you know the reason why your mom wants it? You should trust your mom isn't going to do something illegal with it. I'm sure there must be a valid reason behind her request.</p>
                                    <p class="from-them">She might go to jail if she uses it without my knowledge..</p>
                                    <p class="from-me">You may be worrying too much about this. Most likely she needs it to file something and it's as simple as that. Best thing to do is talk with her and see what she actually needs it for.</p>
                                    <div class="p-3 mb-1 mt-3" style="background-color: #ffe066"><b>Rule-of-thumb 1:</b> It's good to trust your mother.</div>
                                    <div class="p-3 mb-2 bg-light "><b>Why this rule-of-thumb is especially good:</b><br> Reveals the implicit rule-of-thumb in the response.</div>
                                    <div class="p-3 mb-1 mt-1" style="background-color: #ffe066"><b>Rule-of-thumb 2:</b> It's good to ask others to clarify your doubts.</div>
                                 </div>
                              </div>
                           </div>
                        </div>
                     </div>

                     <div class="row  border-bottom mb-3">
                        <h5 class="col col-12 bg-dark text-light">Example 6</h5>
                        <div class="card-group">
                           <div class="card">
                              <div class="card-body">
                                 <h5 class="card-title">Dialogue context 1</h5>
                                 <div class="imessage">
                                    <p class="from-them">I got robbed today at school</p>
                                    <p class="from-me">oh no! what happened?</p>
                                    <p class="from-them">They took the things in my locker.</p>
                                    <p class="from-me">Did you let the authorities know about you being robbed at school?  So it won't happen to anyone else.</p>
                                    <div class="p-3 mb-1 mt-3" style="background-color: #ffe066"><b>Rule-of-thumb 1:</b> You should contact the authorities when you get robbed.</div>
                                 </div>
                              </div>
                           </div>
                           <div class="card">
                              <div class="card-body">
                                 <h5 class="card-title">Dialogue context 2</h5>
                                 <div class="imessage">
                                    <p class="from-them">I got robbed today at school</p>
                                    <p class="from-me">oh no! what happened?</p>
                                    <p class="from-them">They took the things in my locker.</p>
                                    <p class="from-me">Did you let the authorities know about you being robbed at school?  So it won't happen to anyone else.</p>
                                    <p class="from-them">Nah, I wasn't hurt and I don't care what the authorities think.</p>
                                    <p class="from-me">Man that really sucks to be robbed. Did you lose anything of value?</p>
                                    <div class="p-3 mb-1 mt-3" style="background-color: #ffe066"><b>Rule-of-thumb 1:</b> It's hurtful to be robbed at school.</div>
                                 </div>
                              </div>
                           </div>
                        </div>
                     </div>

                  </div>
               </div>
            </div>
         </div>
         <!-- INSTRUCTIONS END -->
      </div>
      <!-- ACCORDION END -->
      <!-- MTURK INPUT START -->
      <div class="row justify-content-center" id="consent-div">
         <div class="col-12 mt-4" style="text-align: center;">
            <h4>Consent to the task</h4>
            <div class="form-check" style="text-align: center"><label class="form-check-label" for="consent"><input checked="checked" class="form-check-input" id="consent" name="consent" onclick="toggleConsent(this.checked)" required="" type="checkbox" /> By ticking this box, you certify that you have <strong>understood</strong> and <strong>agree</strong> with the terms of this study. </label></div>
            &nbsp;
            <div class="col col-12 p-1 mb-2 bg-warning" id="consent-message"><span style="font-size:100%">You must check the box to continue the task!</span></div>
         </div>
      </div>
      <div class="col-12 mt-3 mb-1 border-top" id="main-task">
         <form name='mturk_form' method='post' id='mturk_form'>
            <input type='hidden' value='' name='assignmentId' id='assignmentId'/>
            <input type='hidden' name='ee' id='ee'/>

         <div id="question" class="row mb-3 question-choice-container">
         <div class="card col-12 text-left mt-2 mb-4">
            <div class="card-body bg-light">
               We know there can be redundant RoTs across dialogue context 1 and 2, so those are fine.<br>But, we encourage you to write <b>two clearly distinct</b> rules-of-thumb (RoTs) for an utterance.
               <br>Although we assume many of them to include two RoTs, <i>please do not over think to write two RoTs</i>.
               <br><u>If you can't see another distinct RoT right away, it's okay to just write one</u>.
               <br>
               <br><span class="badge badge-primary">Notice!</span> <b>Please refrain from writing reasons behind the RoTs followed after "because" or "so".</b>
               <br>For example, "<i>It's good to report payroll problems quickly, so you don't appear suspicious</i>" should be trimmed to "<i>It's good to report payroll problems quickly.</i>". This is because we want the basic form of RoTs.<br>

               <br><b>Please do not write RoTs in a rude tone.</b>
               <br> Bad examples: (1) <i>It's stupid to play dangerous pranks</i>. (2) <i>You shouldn't be such a pain in the *** at work</i>.<br><br>
               <!-- <span class="badge badge-danger">Notice!</span> We encourage writing <b>two clearly distinct</b> rules-of-thumb per dialogue context. If this is not possible, just write one.<br><br> -->

               <!-- <span class="badge badge-warning">Note</span> The basic rule is to write the rules-of-thumb (RoT) implied in <span class="badge badge-secondary">gray</span>'s response. The RoTs you write <b>must</b> be implied in gray's response.<br><br> -->
               <span class="badge badge-warning">Common Errors.</span>
               <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#common_errors" aria-expanded="false" aria-controls="examples">
               Please read carefully. (click to expand/collapse) </span>
               </button>
               <div class="collapse" id="common_errors">
                  <ol>
                     <li>Writing two similar RoTs for an utterance</li>
                     <span class="badge-secondary"> Oh dear, so you are planning on lying to him. It's not good for partners to lie to each other. You should always be honest with him. </span>
                     <ul>
                        <li>RoT 1:  It's not okay to lie to your partner.</li>
                        <li>RoT 2:  It's good to be honest with people you care about.</li>
                     </ul>
                     <b>→ These two RoTs are pretty much the same, so you should have written just one of the two.</b>
                     <li>Writing a too specific RoT and a generalized RoT together</li>
                     <span class="badge-secondary"> It's wrong to hit anyone. You should be more careful with people. </span>
                     <ul>
                        <li>RoT 1:  You should refrain from violence.</li>
                        <li>RoT 2:  Its wrong to hit a girl for coughing on you.</li>
                     </ul>
                     <b>→ Don't write both, combine the two for just the right amount of specificity:</b> <i>It's wrong to hit someone over a cough.</i>
                     <li>Missing some main RoTs, such as RoTs about good behaviors.</li>
                     <span class="badge-secondary"> Giving alcohol to homeless people in hopes that they drink themselves to death causes a lot of harm and is very morally wrong behavior. Homeless people need support to be able to be reintegrated back into society, not drugs that will physically harm them. </span>
                     <ul>
                        <li>RoT 1: It's wrong to experiment things with the homeless.</li>
                     </ul>
                     <b>→ You should also include an RoT something like:</b> <i>It's good to help the homeless return to society.</i>
                  </ol>
               </div>
               <!-- The basic rule is to write the rules-of-thumb (RoT) implied in <span class="badge badge-secondary">gray</span>'s response. The RoTs you write <b>must</b> be implied in gray's response.<br><br> -->

               <!-- [<b>When gray is not agreeing with violet</b>] Prioritize writing the rules-of-thumb implied in the response that point out</li>
               <ul>
                  <li>what's wrong with <span class="badge" style="background-color:#9270f7;color:#fff">violet</span>'s behavior.</li>
                  <li>what should <span class="badge" style="background-color:#9270f7;color:#fff">violet</span> do instead of the problematic behavior.</li>
               </ul> -->

               <!-- <span class="badge badge-warning">Note!</span> <span class="b">Some common mistakes from the qual and tips:</span>
               <ol>
                  <li>Don't make the rules-of-thumb too wordy. If it looks somewhat wordy, then it's likely that the rule-of-thumb might be too specific.</li>
                  <li>Don't use pronouns for characters. The rules-of-thumb must be understandable by it's own.</li>
                  <li>We encourage hypernyms for characters. For example, use family member or grandparent instead of grandmother. Use children or kids instead of daughter and son.</li>
               </ol> -->
            </div>
         </div>

            <div class="col col-12 p-2 mb-2 mt-2 text-white" style="background-color: #545258"><span style="font-size:140%">What rules-of-thumb are implied in gray's response? <span class='emoji-bytes' data-emoji-bytes='[240, 159, 164, 148]'></span></span></div>
            <p class="text-body">Given a dialogue between <span class="badge" style="background-color:#9270f7;color:#fff">speaker violet</span> and <span class="badge badge-secondary">speaker gray</span>, write <i>one or two</i> rules-of-thumb implied in <span class="badge badge-secondary">speaker gray</span>'s utterances.</p>
            <div class="col-12 mb-4">
               <div class="card-group col-12 justify-content-center pt-4">
                  <div class="card col-6">
                     <div class="card-body">
                        <h5 class="card-title">Dialogue context 1</h5>
                        <p class="card-text">
                           <div class="imessage">
                              <p class="from-them"><span id="fix1-text-orig" >${context1}</span><span id="fix1-text" style="display:none;">fix</span></p>

                              <p class="from-me"><span id="fix2-text-orig" >${context2}</span><span id="fix2-text" style="display:none;">fix</span></p>

                              <p class="from-them"><span id="fix3-text-orig" >${context3}</span><span id="fix3-text" style="display:none;">fix</span></p>

                              <p class="from-me"><span id="fix4-text-orig" >${context4}</span><span id="fix4-text" style="display:none;">fix</span></p>
                           </div>
                        </p>
                     </div>
                     <div class="card-body">
                        <h6 class="card-title">Dialogue context 2 (continued)</h6>
                        <p class="card-text">
                           <div class="imessage">
                              <p class="from-them"><span id="fix5-text-orig" >${context5}</span><span id="fix5-text" style="display:none;">fix</span></p>

                              <p class="from-me"><span id="fix6-text-orig" >${context6}</span><span id="fix6-text" style="display:none;">fix</span></p>
                           </div>
                        </p>
                     </div>
                  </div>
                  <div class="card col-6">
                     <div class="card-body d-flex flex-column border-bottom">
                        <div class="mt-auto pt-1 btn-group-container show">
                           <div class="mb-3"><i>In the left dialogue, the rules-of-thumb implied in <span class="badge badge-secondary">speaker gray</span>'s <b>second utterance</b> are:</i></div>
                           <div class="context3-short-length-error alert alert-danger collapse">You must write your rules-of-thumb! (longer than 15 letters)</div>
                           <div class="context3-long-length-error alert alert-danger collapse">Please check whether your rule-of-thumb is not too wordy! (We prefer ones with less than 18 words)</div>
                           <div class="context3-rot-copy-error alert alert-danger collapse">You wrote identical rules-of-thumb in this Dialogue context 1</div>
                           <div class="row ml-2">
                              <textarea class="form-control context3-rot row mb-3" id="context3-rot1" name="context3-rot1" placeholder="Rule-of-thumb 1:" rows=2 cols=60></textarea>
                              <textarea class="form-control context3-rot row mb-3" id="context3-rot2" name="context3-rot2" placeholder="Rule-of-thumb 2:" rows=2 cols=60></textarea>
                              <!-- <textarea class="form-control context3-rot row mb-3" id="context3-rot3" name="context3-rot3" placeholder="Rule-of-thumb 3:" rows=1 cols=40></textarea> -->
                           </div>
                        </div>
                     </div>
                     <div class="card-body d-flex flex-column">
                        <div class="mt-auto pt-1 btn-group-container show">
                           <div class="mb-3"><i>In the left dialogue, the rules-of-thumb implied in <span class="badge badge-secondary">speaker gray</span>'s <b>last utterance</b> are:</i></div>
                           <div class="context5-short-length-error alert alert-danger collapse">You must write your rules-of-thumb! (longer than 15 letters)</div>
                           <div class="context5-long-length-error alert alert-danger collapse">Please check whether your rule-of-thumb is not too wordy! (We prefer ones with less than 18 words)</div>
                           <div class="context5-rot-copy-error alert alert-danger collapse">You wrote identical rules-of-thumb in this Dialogue context 2</div>
                           <div class="intercontext-rot-copy-error alert alert-danger collapse">You must write different rules-of-thumb from those of Dialogue context 1 (at least paraphrase it)</div>
                           <div class="row ml-2">
                              <textarea class="form-control context5-rot row mb-3" id="context5-rot1" name="context5-rot1" placeholder="Rule-of-thumb 1:" rows=2 cols=60></textarea>
                              <textarea class="form-control context5-rot row mb-3" id="context5-rot2" name="context5-rot2" placeholder="Rule-of-thumb 2:" rows=2 cols=60></textarea>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
            </div>

            <div class="col-12 border-top">
               <div class="form-check mt-4 offset-1" style="text-align: left"><label class="form-check-label" for="nonsensical"><input class="form-check-input" id="nonsensical" name="nonsensical" type="checkbox" /><span class="badge badge-success">Note!</span> Please check this box if the dialogue is <i>nonsensical</i> or some utterances are <i>completely off</i>.</label></div>
               <div class="form-check mt-2 offset-1" style="text-align: left"><label class="form-check-label" for="misguidance"><input class="form-check-input" id="misguidance" name="misguidance" type="checkbox" /><span class="badge badge-warning">Note!</span> Please check this box if <span class="badge badge-secondary">speaker gray</span> gives <i>socially inappropriate</i> feedback <small><i><b>(also includes rude and accusatory tone)</b></i></small>.</label></div>
            </div>
         </div>

         <!-- OPTIONAL FEEDBACK -->
         <div class="row mt-5 mb-5">
            <div class="col-8 offset-2 col-lg-6 offset-lg-3">
               <p><span class='emoji-bytes' data-emoji-bytes='[240, 159, 148, 148]'></span> <strong>Optional Feedback</strong>: Thanks for filling out the HIT above! If something about the HIT was unclear, please leave a comment in the box below! We would like to make this HIT easier for future workers, so we really appreciate feedback though it is optional. If you have concerns or questions, please email us!</p>
               <textarea id="feedback" name="feedback" rows=3></textarea>
            </div>
         </div>

         <div class="card text-center mt-4">
            <div class="card-body bg-light">
               <span class="badge badge-primary">Notice!</span> See the new notification below the consent checkbox :)
            </div>
         </div>

         <!-- SUBMIT BUTTON -->
         <div class="row mt-5">
            <div class="col-2 offset-5">
                <input class="submit btn btn-primary" id="submitButton" onclick="getnext()" type="submit" value="Submit">
            </div>
         </div>
         </form>
         <script language='Javascript'>turkSetAssignmentID();</script>
      </div>
      <!-- MTURK INPUT END -->
   </div>
   <!-- HIT END -->
   <!-- BOOSTRAP JS -->
   <!-- <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script> -->
   <script src="https://code.jquery.com/jquery-3.3.1.js" integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60=" crossorigin="anonymous"></script>
   <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
   <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
   <!-- HITPUB JS -->
   <script id="hitpub_js">
      var e;
      var condition;
      $(document).ready(function() {
         var qtype = Math.floor(Math.random() * 3);
         $('#qtype').val(qtype)
         if(qtype == 0){
            $('.aq2').each(function(){$(this).hide();});
            $('.aq3').each(function(){$(this).hide();});
            $('.aq1').each(function(){$(this).show();});
         } else if(qtype == 1){
            $('.aq1').each(function(){$(this).hide();});
            $('.aq3').each(function(){$(this).hide();});
            $('.aq2').each(function(){$(this).show();});
         } else if(qtype == 2){
            $('.aq1').each(function(){$(this).hide();});
            $('.aq2').each(function(){$(this).hide();});
            $('.aq3').each(function(){$(this).show();});
         }
         $('.statement').each(function(){
            if($(this).text() === "[NONE]"){
               $(this).closest('div').hide();
            };
         });
         // $('#context3-rot1').focus();
      });

      (function () { var e, t; e = this, t = function () { var r = { startStopTimes: {}, idleTimeoutMs: 3e4, currentIdleTimeMs: 0, checkStateRateMs: 250, active: !1, idle: !1, currentPageName: "default-page-name", timeElapsedCallbacks: [], userLeftCallbacks: [], userReturnCallbacks: [], trackTimeOnElement: function (e) { var t = document.getElementById(e); t && (t.addEventListener("mouseover", function () { r.startTimer(e) }), t.addEventListener("mousemove", function () { r.startTimer(e) }), t.addEventListener("mouseleave", function () { r.stopTimer(e) }), t.addEventListener("keypress", function () { r.startTimer(e) }), t.addEventListener("focus", function () { r.startTimer(e) })) }, getTimeOnElementInSeconds: function (e) { var t = r.getTimeOnPageInSeconds(e); return t || 0 }, startTimer: function (e, t) { if (e || (e = r.currentPageName), void 0 === r.startStopTimes[e]) r.startStopTimes[e] = []; else { var n = r.startStopTimes[e], i = n[n.length - 1]; if (void 0 !== i && void 0 === i.stopTime) return } r.startStopTimes[e].push({ startTime: t || new Date, stopTime: void 0 }), r.active = !0, r.idle = !1 }, stopAllTimers: function () { for (var e = Object.keys(r.startStopTimes), t = 0; t < e.length; t++)r.stopTimer(e[t]) }, stopTimer: function (e, t) { e || (e = r.currentPageName); var n = r.startStopTimes[e]; void 0 !== n && 0 !== n.length && (void 0 === n[n.length - 1].stopTime && (n[n.length - 1].stopTime = t || new Date), r.active = !1) }, getTimeOnCurrentPageInSeconds: function () { return r.getTimeOnPageInSeconds(r.currentPageName) }, getTimeOnPageInSeconds: function (e) { var t = r.getTimeOnPageInMilliseconds(e); return void 0 === t ? void 0 : t / 1e3 }, getTimeOnCurrentPageInMilliseconds: function () { return r.getTimeOnPageInMilliseconds(r.currentPageName) }, getTimeOnPageInMilliseconds: function (e) { var t = r.startStopTimes[e]; if (void 0 !== t) { for (var n = 0, i = 0; i < t.length; i++) { var s = t[i].startTime, o = t[i].stopTime; void 0 === o && (o = new Date), n += o - s } return Number(n) } }, getTimeOnAllPagesInSeconds: function () { for (var e = [], t = Object.keys(r.startStopTimes), n = 0; n < t.length; n++) { var i = t[n], s = r.getTimeOnPageInSeconds(i); e.push({ pageName: i, timeOnPage: s }) } return e }, setIdleDurationInSeconds: function (e) { var t = parseFloat(e); if (!1 !== isNaN(t)) throw { name: "InvalidDurationException", message: "An invalid duration time (" + e + ") was provided." }; return r.idleTimeoutMs = 1e3 * e, this }, setCurrentPageName: function (e) { return r.currentPageName = e, this }, resetRecordedPageTime: function (e) { delete r.startStopTimes[e] }, resetAllRecordedPageTimes: function () { for (var e = Object.keys(r.startStopTimes), t = 0; t < e.length; t++)r.resetRecordedPageTime(e[t]) }, resetIdleCountdown: function () { r.idle && r.triggerUserHasReturned(), r.idle = !1, r.currentIdleTimeMs = 0 }, callWhenUserLeaves: function (e, t) { this.userLeftCallbacks.push({ callback: e, numberOfTimesToInvoke: t }) }, callWhenUserReturns: function (e, t) { this.userReturnCallbacks.push({ callback: e, numberOfTimesToInvoke: t }) }, triggerUserHasReturned: function () { if (!r.active) for (var e = 0; e < this.userReturnCallbacks.length; e++) { var t = this.userReturnCallbacks[e], n = t.numberOfTimesToInvoke; (isNaN(n) || void 0 === n || 0 < n) && (t.numberOfTimesToInvoke -= 1, t.callback()) } r.startTimer() }, triggerUserHasLeftPage: function () { if (r.active) for (var e = 0; e < this.userLeftCallbacks.length; e++) { var t = this.userLeftCallbacks[e], n = t.numberOfTimesToInvoke; (isNaN(n) || void 0 === n || 0 < n) && (t.numberOfTimesToInvoke -= 1, t.callback()) } r.stopAllTimers() }, callAfterTimeElapsedInSeconds: function (e, t) { r.timeElapsedCallbacks.push({ timeInSeconds: e, callback: t, pending: !0 }) }, checkState: function () { for (var e = 0; e < r.timeElapsedCallbacks.length; e++)r.timeElapsedCallbacks[e].pending && r.getTimeOnCurrentPageInSeconds() > r.timeElapsedCallbacks[e].timeInSeconds && (r.timeElapsedCallbacks[e].callback(), r.timeElapsedCallbacks[e].pending = !1); !1 === r.idle && r.currentIdleTimeMs > r.idleTimeoutMs ? (r.idle = !0, r.triggerUserHasLeftPage()) : r.currentIdleTimeMs += r.checkStateRateMs }, visibilityChangeEventName: void 0, hiddenPropName: void 0, listenForVisibilityEvents: function () { void 0 !== document.hidden ? (r.hiddenPropName = "hidden", r.visibilityChangeEventName = "visibilitychange") : void 0 !== document.mozHidden ? (r.hiddenPropName = "mozHidden", r.visibilityChangeEventName = "mozvisibilitychange") : void 0 !== document.msHidden ? (r.hiddenPropName = "msHidden", r.visibilityChangeEventName = "msvisibilitychange") : void 0 !== document.webkitHidden && (r.hiddenPropName = "webkitHidden", r.visibilityChangeEventName = "webkitvisibilitychange"), document.addEventListener(r.visibilityChangeEventName, function () { document[r.hiddenPropName] ? r.triggerUserHasLeftPage() : r.triggerUserHasReturned() }, !1), window.addEventListener("blur", function () { r.triggerUserHasLeftPage() }), window.addEventListener("focus", function () { r.triggerUserHasReturned() }), document.addEventListener("mousemove", function () { r.resetIdleCountdown() }), document.addEventListener("keyup", function () { r.resetIdleCountdown() }), document.addEventListener("touchstart", function () { r.resetIdleCountdown() }), window.addEventListener("scroll", function () { r.resetIdleCountdown() }), setInterval(function () { r.checkState() }, r.checkStateRateMs) }, websocket: void 0, websocketHost: void 0, setUpWebsocket: function (e) { if (window.WebSocket && e) { var t = e.websocketHost; try { r.websocket = new WebSocket(t), window.onbeforeunload = function () { r.sendCurrentTime(e.appId) }, r.websocket.onopen = function () { r.sendInitWsRequest(e.appId) }, r.websocket.onerror = function (e) { console && console.log("Error occurred in websocket connection: " + e) }, r.websocket.onmessage = function (e) { console && console.log(e.data) } } catch (e) { console && console.error("Failed to connect to websocket host.  Error:" + e) } } return this }, websocketSend: function (e) { r.websocket.send(JSON.stringify(e)) }, sendCurrentTime: function (e) { var t = { type: "INSERT_TIME", appId: e, timeOnPageMs: r.getTimeOnCurrentPageInMilliseconds(), pageName: r.currentPageName }; r.websocketSend(t) }, sendInitWsRequest: function (e) { var t = { type: "INIT", appId: e }; r.websocketSend(t) }, initialize: function (e) { var t = r.idleTimeoutMs || 30, n = r.currentPageName || "default-page-name", i = void 0, s = void 0; e && (t = e.idleTimeoutInSeconds || t, n = e.currentPageName || n, i = e.websocketOptions, s = e.initialStartTime), r.setIdleDurationInSeconds(t).setCurrentPageName(n).setUpWebsocket(i).listenForVisibilityEvents(), r.startTimer(void 0, s) } }; return r }, "undefined" != typeof module && module.exports ? module.exports = t() : "function" == typeof define && define.amd ? define([], function () { return e.TimeMe = t() }) : e.TimeMe = t() }).call(this);

      TimeMe.initialize({
          currentPageName: "task",
          idleTimeoutInSeconds: 30
      });

      $(document).ready(function() {
         $('#submitButton').click(function () {
             try {
                 $('input[name=ee]').attr('value', TimeMe.getTimeOnCurrentPageInSeconds());
             } catch {
             }
             return true;
         });
         $('span.emoji-bytes').each(displayEmoji);
      });

      // $(document).ready(function() {
      //    $('span.emoji-bytes').each(displayEmoji);
      // });

      function toggleConsent(checked){
        if (checked){
          $("#main-task").show();
          $("#consent-message").hide();
        } else {
          $("#main-task").hide();
          $("#consent-message").show();
        }
      }

      function attentionCheck(radio) {
        var qtype = $('#qtype').val()
        if (qtype == 0 && radio.checked && radio.id == "attention4") {
          $('#pass').val('true')
        } else if (qtype == 1 && radio.checked && radio.id == "attention3") {
          $('#pass').val('true')
        } else if (qtype == 2 && radio.checked && radio.id == "attention2") {
          $('#pass').val('true')
        } else {
          $('#pass').val('false')
        }
      }

      function autoEmergencyClick(radio){
         // var context = radio.name;
         // var context_num = parseInt(context.slice(-1)) + 2
         // for (i=context_num; i<=5; i += 2) {
         //    // clear the later radios and re-check them as emergency.
         //    $('input[name="safety' + i + '"]:checked').prop('checked', false)
         //    $("#emergency" + i).prop('checked', true);

         //    // clear the later rationale popups
         //    $('.rationale' + i).each(function(){$(this).hide();});
         //    $('.rationale' + i).each(function(){$(this).val('');});

         //    // popup rationales for later emergency radios is needed
         //    $('#emergency' + i + '-rationale').each(function(){$(this).show();});
         // }
      }

      function rationaleInputPopup(radio) {
         var context = radio.name;
         var context_num = context.slice(-1)
         $('.rationale' + context_num).each(function(){$(this).hide();}); // hide all rationale boxes
         $('#unsafe1-rationale-notice').each(function(){$(this).hide();}); // hide notice
         $('#emergency1-rationale-notice').each(function(){$(this).hide();}); // hide notice
         $('.rationale' + context_num).each(function(){$(this).val('');}); // clear the existing values in the boxes
         $('#' + radio.id + '-rationale').each(function(){$(this).show();}); // pop-up box for the selected value
         $('#' + radio.id + '-rationale-notice').each(function(){$(this).show();}); // pop-up notice for the selected value
         $('#' + radio.id + '-rationale').each(function(){$(this).focus();}); // auto-focus
      }

      function changeDialog(el) {
        var name = el.id;
        var text = $(el).prop("value");
        var fixed_utterance = $("#"+name+"-text");
        var original_utterance = $("#"+name+"-text-orig");
        if (text.length > 0){
          document.getElementById(name+"-text").textContent = text;
          fixed_utterance.show();
          original_utterance.hide();
        } else {
          fixed_utterance.hide();
          original_utterance.show();
        }
      }

      $(function(){
          var requiredCheckboxes = $('.imessage :checkbox[required]');
          requiredCheckboxes.change(function(){
              if(requiredCheckboxes.is(':checked')) {
                  requiredCheckboxes.removeAttr('required');
              } else {
                  requiredCheckboxes.attr('required', 'required');
              }
          });
      });

      function countSentences(text){
        var match = text.match(/[\w\)"][.?!](?:\s|$)/gm);
        return match === null ? 0: match.length;
      }
      function updateCounter(el,minS,maxS,minC,maxC){
        var name = el.id;
        var counter = $("#"+name+"-sentence-counter");
        var text = $(el).prop("value");
        var nSents = countSentences(text);
        var nChars = text.length;
        var warnText = "";
        counter.css('color', 'black');

        if (nSents >= minS && nChars < maxC)
          warnText = " ✓";

        if (nSents > maxS || nChars > maxC) {
          warnText = " (try shortening it)";
          counter.css('color', '#721c24');
        }
        counter.html(nSents+" sentences ("+nChars+" characters) detected"+warnText);
      }

      function checkResponse(){
         $(".context3-short-length-error").hide();
         $(".context5-short-length-error").hide();
         $(".context3-long-length-error").hide();
         $(".context5-long-length-error").hide();
         $(".context3-rot-copy-error").hide();
         $(".context5-rot-copy-error").hide();
         $(".intercontext-rot-copy-error").hide();

         // get written rots
         var context3_rots = [];
         var context5_rots = [];
         for (var i = 1; i < 3; i++) {
            var context3_rot = $("#context3-rot" + i).prop("value")
            if (context3_rot != ''){
               context3_rots.push(context3_rot);
            }

            var context5_rot = $("#context5-rot" + i).prop("value")
            if (context5_rot != ''){
               context5_rots.push(context5_rot);
            }
         }

         // check minimum length violation
         var rot_minimum_length = 15;
         var rot_maximum_word_length = 18;
         var context3_rot_short_length_check = true;
         var context3_rot_long_length_check = true;
         for (const rot of context3_rots) {
            if (rot.length > rot_minimum_length){
               context3_rot_short_length_check = false;
            }
            if (rot.split(' ').length < rot_maximum_word_length){
               context3_rot_long_length_check = false;
            }
            console.log(rot.split(' ').length)
         }
         if (context3_rot_short_length_check){
            $(".context3-short-length-error").show();
         }
         if (context3_rot_long_length_check){
            $(".context3-long-length-error").show();
         }
         // check copy-paste within context3 rots
         // TODO: skip blanks
         var context3_unique_rots = new Set(context3_rots)
         context3_rot_copy_check = context3_unique_rots.size != context3_rots.length
         if (context3_rot_copy_check){
            $(".context3-rot-copy-error").show();
         }

         // check minimum and maximum length violation
         var context5_rot_short_length_check = true;
         var context5_rot_long_length_check = true;
         for (const rot of context5_rots) {
            if (rot.length > rot_minimum_length){
               context5_rot_short_length_check = false;
            }
            if (rot.split(' ').length < rot_maximum_word_length){
               context5_rot_long_length_check = false;
            }
            console.log(rot.split(' ').length)
         }
         if (context5_rot_short_length_check){
            $(".context5-short-length-error").show();
         }
         if (context5_rot_long_length_check){
            $(".context5-long-length-error").show();
         }

         // check copy-paste within context5 rots
         var context5_unique_rots = new Set(context5_rots)
         context5_rot_copy_check = context5_unique_rots.size != context5_rots.length
         if (context5_rot_copy_check){
         // if (context5_unique_rots.size != context5_rots.length){
            $(".context5-rot-copy-error").show();
         }

         // check copy-paste across contexts
         var intercontext_rot_copy_check = true;
         for (var i = 0; i < 2; i++){
            console.log(context3_rots[i])
            console.log(context5_rots[i])
            if (context3_rots[i] != context5_rots[i]){
               intercontext_rot_copy_check = false;
            }
         }
         if (intercontext_rot_copy_check){
            $(".intercontext-rot-copy-error").show();
         }

         if (context3_rot_short_length_check || context5_rot_short_length_check || context3_rot_copy_check || context5_rot_copy_check || intercontext_rot_copy_check) {
            // cannot submit
            return false;
         } else {
            return true;
         }

         // var context3_rot1 = $("#context3-rot1").prop("value");
         // var context3_rot2 = $("#context3-rot2").prop("value");
         // var context3_rot3 = $("#context3-rot3").prop("value");

         // var context5_rot1 = $("#context5-rot1").prop("value");
         // var context5_rot2 = $("#context5-rot2").prop("value");
         // var context5_rot3 = $("#context5-rot3").prop("value");

         // the rots should be longer than minimum number of letters
         // var rot_minimum_length = 15

         // if ((context3_rot1.length > rot_minimum_length || context3_rot2.length > rot_minimum_length || context3_rot3.length > rot_minimum_length)
         // && (context5_rot1.length > rot_minimum_length || context5_rot2.length > rot_minimum_length || context5_rot3.length > rot_minimum_length)){
         //    return true;
         // } else {
         //    if (!(context3_rot1.length > rot_minimum_length || context3_rot2.length > rot_minimum_length || context3_rot3.length > rot_minimum_length)){
         //       $(".context3-length-error").show();
         //    }
         //    if (!(context5_rot1.length > rot_minimum_length || context5_rot2.length > rot_minimum_length || context5_rot3.length > rot_minimum_length)){
         //       $(".context5-length-error").show();
         //    }
         //    return false;
         // }

         // check copy-paste response
      }

      $("#submitButton").on("click",function(e){
         var ok = checkResponse();
         console.log("Answer ok? "+ok);

         if (!ok) {
            $("#cantSubmit").show();
            $(":invalid").addClass("invalid");
            $(".lickert>input:invalid").parents().addClass("invalid");
            $(".form-check>input:invalid").parents().addClass("invalid");
            e.preventDefault();
         } else{
            $("#cantSubmit").hide();
            return true;
         }
      });
   </script>

   <script id='emoji_js'>
      function displayEmoji() {

      /**
       * utf8ByteArrayToString() copied from:
       *   https://github.com/google/closure-library/blob/e877b1eac410c0d842bcda118689759512e0e26f/closure/goog/crypt/crypt.js
       *
       * Converts a UTF-8 byte array to JavaScript's 16-bit Unicode.
       * @param {Uint8Array|Array<number>} bytes UTF-8 byte array.
       * @return {string} 16-bit Unicode string.
       */
      var utf8ByteArrayToString = function(bytes) {
      var out = [], pos = 0, c = 0;
      while (pos < bytes.length) {
         var c1 = bytes[pos++];
         if (c1 < 128) {
            out[c++] = String.fromCharCode(c1);
         } else if (c1 > 191 && c1 < 224) {
            var c2 = bytes[pos++];
            out[c++] = String.fromCharCode((c1 & 31) << 6 | c2 & 63);
         } else if (c1 > 239 && c1 < 365) {
            // Surrogate Pair
            var c2 = bytes[pos++];
            var c3 = bytes[pos++];
            var c4 = bytes[pos++];
            var u = ((c1 & 7) << 18 | (c2 & 63) << 12 | (c3 & 63) << 6 | c4 & 63) -
                  0x10000;
            out[c++] = String.fromCharCode(0xD800 + (u >> 10));
            out[c++] = String.fromCharCode(0xDC00 + (u & 1023));
         } else {
            var c2 = bytes[pos++];
            var c3 = bytes[pos++];
            out[c++] =
            String.fromCharCode((c1 & 15) << 12 | (c2 & 63) << 6 | c3 & 63);
         }
      }
      return out.join('');
      }

      jQuery(this).text(utf8ByteArrayToString(JSON.parse(jQuery(this).attr('data-emoji-bytes'))));
      }
   </script>
   <!-- For charting JS -->
   <script src="https://cdn.anychart.com/releases/8.9.0/js/anychart-base.min.js" type="text/javascript"></script>
   <!-- LIGHTBOX JS -->
   <script src="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.1/js/lightbox-plus-jquery.min.js"></script>
